<!DOCTYPE html>
<html lang="bg">
<head>
    <script src="https://js.stripe.com/v3/"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Parking Sofia</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body class="light-mode">

    <div id="register-screen" class="screen" style="z-index: 4500; display: none;">
        <div class="auth-container">
            <h2>–°—ä–∑–¥–∞–π –ü—Ä–æ—Ñ–∏–ª</h2>
            <div class="edit-group">
                <label>–ò–º–µ –∏ –§–∞–º–∏–ª–∏—è *</label>
                <input type="text" id="regName" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
            </div>
            <div class="edit-group">
                <label>–ò–º–µ–π–ª *</label>
                <input type="email" id="regEmail" placeholder="example@mail.com">
            </div>
            <div class="edit-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω–µ–Ω –Ω–æ–º–µ—Ä *</label>
                <input type="tel" id="regPhone_new" placeholder="0888 xxx xxx">
            </div>
            <div class="edit-group">
                <label>–ü–∞—Ä–æ–ª–∞ *</label>
                <input type="password" id="regPass" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–∞">
            </div>
            <div class="edit-group">
                <label>–ü–æ—Ç–≤—ä—Ä–¥–∏ –ü–∞—Ä–æ–ª–∞ *</label>
                <input type="password" id="regPassConfirm" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞ –æ—Ç–Ω–æ–≤–æ">
            </div>
            <button class="btn-main btn-green" onclick="window.processNewRegistration()">–ó–ê–í–™–†–®–ò –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø–¢–ê</button>
            <button class="btn-main" style="background:#888; margin-top:10px;" onclick="window.closeRegister()">–û—Ç–∫–∞–∑</button>
        </div>
    </div>

    <div id="map"></div>

    <div id="login-screen" class="screen" style="display: block; z-index: 4000;">
        <div class="auth-container">
            <h2 id="lang-auth-title">–í–ª–µ–∑ –≤ My Parking</h2>
            <div class="edit-group">
                <label>–ò–º–µ–π–ª</label>
                <input type="email" id="authEmail">
            </div>
            <div class="edit-group">
                <label>–ü–∞—Ä–æ–ª–∞</label>
                <input type="password" id="authPass">
            </div>
            <div style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                <input type="checkbox" id="rememberMe" style="width: 20px; height: 20px;">
                <label for="rememberMe" style="font-size: 14px;">–ó–∞–ø–æ–º–Ω–∏ –º–µ</label>
            </div>
            <button class="btn-main btn-green" onclick="window.handleAuth()" id="btn-auth-main" style="margin-bottom: 12px;">–í–•–û–î</button>
            <button class="btn-main" onclick="window.handleRegister()" id="btn-reg-main" style="background: #2c3e50; color: white;">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <button class="btn-main" style="background:#888; margin-top:10px;" onclick="window.loginAsGuest()" id="btn-guest">–í–ª–µ–∑ –∫–∞—Ç–æ –ì–æ—Å—Ç</button>
        </div>
    </div>

    <div id="profile-screen" class="screen">
        <div id="profile-locked" style="text-align: center; margin-top: 50px;">
            <p>–¢—Ä—è–±–≤–∞ –¥–∞ –≤–ª–µ–∑–µ—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏, –∑–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ —Ç–∞–∑–∏ —Å–µ–∫—Ü–∏—è.</p>
            <button class="btn-main btn-green" onclick="location.reload()">–ö–™–ú –í–•–û–î</button>
        </div>
        <div id="profile-content" style="display:none; padding: 20px;">
            <div class="section-title">–ú–û–ò–¢–ï –ê–í–¢–û–ú–û–ë–ò–õ–ò</div>
            <div id="cars-list"></div>
            <button class="btn-main" onclick="window.addNewCarField()" style="background: #3498db; margin: 15px 0;">+ –î–û–ë–ê–í–ò –î–†–£–ì–ê –ö–û–õ–ê</button>
            
            <div class="section-title" style="color:#27ae60; margin-top:30px;">–°—Ç–∞–Ω–∏ Lender</div>
            <div class="edit-group">
                <label>–¢–∏–ø –æ–±–µ–∫—Ç</label>
                <select id="lType">
                    <option value="–ì–∞—Ä–∞–∂">–ì–∞—Ä–∞–∂</option>
                    <option value="–ó–∞—Ç–≤–æ—Ä–µ–Ω –≥–∞—Ä–∞–∂">–ó–∞—Ç–≤–æ—Ä–µ–Ω –≥–∞—Ä–∞–∂</option>
                    <option value="–ü–∞—Ä–∫–æ–º—è—Å—Ç–æ">–ü–∞—Ä–∫–æ–º—è—Å—Ç–æ</option>
                    <option value="–ü–æ–¥–∑–µ–º–µ–Ω –ø–∞—Ä–∫–∏–Ω–≥">–ü–æ–¥–∑–µ–º–µ–Ω –ø–∞—Ä–∫–∏–Ω–≥</option>
                </select>
            </div>
            <div class="edit-group"><label>–ê–¥—Ä–µ—Å *</label><input type="text" id="lAddr"></div>
            <div class="edit-group"><label>–°–Ω–∏–º–∫–∏ (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ) *</label><input type="file" id="lPhotos" multiple accept="image/*"></div>
            <div class="edit-group"><label>–í–∏–¥–µ–æ (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ) *</label><input type="file" id="lVideo" accept="video/*"></div>
            <div class="edit-group"><label>–¢–µ–ª–µ—Ñ–æ–Ω –∑–∞ –≤—Ä—ä–∑–∫–∞ *</label><input type="tel" id="lPhone"></div>
            <button class="btn-main btn-green" onclick="window.sendLenderRequest()" id="btn-lender-send">–ò–ó–ü–†–ê–¢–ò –ó–ê–Ø–í–ö–ê</button>
        </div>
    </div>

    <div id="settings-screen" class="screen">
        <div class="auth-container">
            <h2 id="lang-settings-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <button class="btn-main btn-nav" onclick="window.toggleDarkMode()" style="background:#eee; margin-bottom:10px;">üåì Dark / Light Mode</button>
            
            <div class="settings-section">
                <h3 class="section-title">üë§ –õ–∏—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div class="edit-group">
                    <label>–ò–º–µ –∏ –§–∞–º–∏–ª–∏—è</label>
                    <input type="text" id="edit-name">
                </div>
                <div class="edit-group">
                    <label>–ò–º–µ–π–ª –∞–¥—Ä–µ—Å</label>
                    <input type="email" id="edit-email">
                </div>
                <div class="edit-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω–µ–Ω –Ω–æ–º–µ—Ä</label>
                    <input type="tel" id="edit-phone">
                </div>
                <button class="btn-main btn-green" onclick="window.updateFullProfile()">‚úÖ –ó–ê–ü–ê–ó–ò –ü–†–û–ú–ï–ù–ò–¢–ï</button>
            </div>

            <div class="edit-group">
                <label id="lang-label">–ï–∑–∏–∫</label>
                <select id="langSelect" onchange="window.changeLang()">
                    <option value="bg">–ë—ä–ª–≥–∞—Ä—Å–∫–∏</option>
                    <option value="en">English</option>
                </select>
            </div>
            <button class="btn-main btn-red" onclick="window.logout()" style="margin-top:30px; background:#e74c3c; color:white;" id="btn-logout">–ò–∑—Ö–æ–¥</button>
        </div>
    </div>

    <div id="bookingSheet" class="bottom-sheet">
        <div class="handle"></div>
        <h2 id="gTitle">–û–±–µ–∫—Ç</h2>
        <p id="gAddress">–ê–¥—Ä–µ—Å</p>
        <div class="counter-box">
            <button class="counter-btn" onclick="window.changeH(-1)">‚àí</button>
            <div id="hLabel">1—á</div>
            <button class="counter-btn" onclick="window.changeH(1)">+</button>
        </div>
        <button class="btn-main btn-nav" onclick="window.showNavOptions()" style="margin-top:10px; background:#eee;" id="btn-nav-draw">üöó –ù–∞–≤–∏–≥–∞—Ü–∏—è</button>
        <div id="navOptions" class="nav-options" style="display:none;">
            <button class="btn-main google-btn" onclick="window.openMap('google')" style="background:#4285F4; color:white;">Google Maps</button>
            <button class="btn-main waze-btn" onclick="window.openMap('waze')" style="background:#33ccff; color:white;">Waze</button>
        </div>
        <div class="price-footer">
            <div><small id="lang-price-label">–¶–ï–ù–ê</small><br><strong id="gPrice">0.00 –ª–≤.</strong></div>
            <button class="btn-main btn-green" onclick="window.sendBookingRequest()" id="btn-book">–†–µ–∑–µ—Ä–≤–∏—Ä–∞–π</button>
        </div>
    </div>

    <nav class="main-nav">
        <button class="nav-item active" onclick="window.nav('map', this)">üìç<span id="nav-map">–ö–∞—Ä—Ç–∞</span></button>
        <button class="nav-item" onclick="window.nav('profile', this)">üë§<span id="nav-profile">–ü—Ä–æ—Ñ–∏–ª</span></button>
        <button class="nav-item" onclick="window.nav('settings', this)">‚öôÔ∏è<span id="nav-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></button>
    </nav>

    <div id="car-selector-modal" style="display:none;">
        <div class="modal-glass-card">
            <div class="modal-header">
                <span class="icon">üöó</span>
                <h3>–ò–∑–±–æ—Ä –Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª</h3>
                <p>–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ —Å –∫–æ—è –∫–æ–ª–∞ —â–µ –ø–∞—Ä–∫–∏—Ä–∞—Ç–µ</p>
            </div>
            <div class="modal-body">
                <div class="select-wrapper">
                    <select id="car-select-dropdown"></select>
                </div>
            </div>
            <button class="confirm-btn" onclick="window.startPayment()"><span>–ü–õ–ê–¢–ò –ò –†–ï–ó–ï–†–í–ò–†–ê–ô</span></button>
            <button class="cancel-link" onclick="window.closeCarModal()">–û—Ç–∫–∞–∑</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>